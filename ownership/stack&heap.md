# 堆栈（Stack）

堆栈是一种先进后出（LIFO, Last In First Out）的数据结构，通常用于函数调用、局部变量存储等场景。堆栈上的内存分配和释放非常快速，因为它是通过调整堆栈指针的位置来完成的，不需要复杂的内存管理操作。

## 堆栈的类比

想想一堆盘子：当你添加更多的盘子时，你把它们放在最上面，当你需要一个盘子时，你从上面取下一个。从中间或底部添加或删除盘子也不会起作用！添加数据称为压入堆栈，移除数据称为弹出堆栈。

# 堆（Heap）

堆是一种动态内存区域，用于程序运行时动态分配的内存空间。与堆栈不同，堆中的内存分配和释放需要更复杂的管理机制，因此操作速度较慢，但堆提供了更大的灵活性，可以支持更大范围的内存需求。

## 堆的类比

想象一下坐在一家餐馆里。当你进去的时候，你说出你所在小组的人数，主人会找到一张适合每个人的空桌子，把你带到那里。如果你的团队中有人迟到了，他们可以问你坐在哪里来找你

## 堆适用的场景

-   动态内存分配：
    当你需要在运行时决定分配多少内存时，堆是一个好选择。例如，当不知道数组的确切大小时，可以使用堆来动态分配足够大的内存。
-   大型数据结构：
    对于大型数据结构（如大数组、链表、树等），堆可以提供足够的内存空间。这些数据结构通常比栈能容纳更多的元素。
-   跨函数调用的数据结构：
    如果一个数据结构需要跨越多个函数调用而存在，则应使用堆。这是因为堆中的对象可以在整个程序执行期间保持有效，而不像堆栈那样在函数退出后就会被销毁。
-   共享数据：
    当多个线程或函数需要访问相同的数据时，堆是更好的选择，因为它可以在不同的函数之间共享。
-   动态增长或收缩的数据结构：
    对于那些可能需要动态增长或收缩的数据结构（如 Vec 或 HashMap），堆是必需的，因为这些数据结构的大小不是固定的。
-   对象生命周期不可预知：
    当对象的生命周期无法在编译时确定时，使用堆进行内存分配可以让程序更灵活地管理内存。

# 小结

简单来说，如果你需要快速的内存分配和释放，并且知道确切的内存需求和生命周期，那么堆栈可能是更好的选择。相反，如果你需要动态分配内存、处理大型数据结构或不确定对象的生命周期，那么堆就是更适合的选择。
